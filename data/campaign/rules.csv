id,trigger,conditions,script,text,options,notes
"#RULESET_NAME Night At Derinkuyu",,,,,,
,,,,,,
# Missions,,,,,,
,,,,,,
# The Derinkuyu Drop,,,,,,
,,,,,,
# Starting Bar Event,,,,,,
naderin_tdd_barOpt,AddBarEvents,"RollProbability 0.3
$market.id != derinkuyu_market
!$global.isInTutorial
!$global.naderin_tdd_acceptedMission","AddBarEvent naderin_tdd_mission ""Speak with the quiet man at the end of the bar"" ""At the end of the bar, a quiet man sits alone tapping on their Tri-Pad. They glance around from time to time, clearly waiting for something — or someone.""",,,
naderin_tdd_barSel,DialogOptionSelected,"$option == naderin_tdd_mission","$missionId = naderin_tdd
NaderinSetActivePerson ""naderin_harlan""
SetTextHighlights 75,000
FireAll naderin_tdd_barDialogOpts","""Finally!"" He breathes a sigh of relief as you approach. ""Nobody's been taking me up on this opportunity, and I've been begging for days!""

""It's just like any other dead drop. Nothing special with the location, nothing special with the package. Can't understand why nobody's taking me up on this!"" There's a trace of uncertainty in their voice.

They laugh unconfidently, tapping on their Tri-Pad far too much. An act, likely just to look busy. In control. But you can see it's all bravado.

And yet, for what?

""I can arrange a payment of 75,000 credits upon completion. No deadline, as long as you make the drop. And, of course, don't be seen making it. All standard stuff. That's okay with you, right?""
",,"# I bet there's an easier way to set the active person that I missed"
naderin_tdd_barSelAgain,DialogOptionSelected,"$option == naderin_tdd_mission
$global.naderin_tdd_missionDeclinedBefore == true","$missionId = naderin_tdd
NaderinSetActivePerson ""naderin_harlan""
SetTextHighlights 75,000
FireAll naderin_tdd_barDialogOpts","""You again?"" He eyes you up and down as you approach. ""Did you change your mind?""

They blink incredulously for a moment, before shaking their head.

""Let me remind you of the details. I'll tell you where to make the drop after you accept. There's no deadline, as long as you complete the drop. You'll receive a payment of 75,000 credits upon completion. And, of course, don't be seen doing the deed. This okay with you?""",,
naderin_tdd_convoAskOpt,naderin_tdd_barDialogOpts,"!$askedDetails",,,"naderin_tdd_convoAsk:""And where would I be delivering this package?""",
naderin_tdd_convoAsk,DialogOptionSelected,"$option == naderin_tdd_convoAsk","$askedDetails = true
FireAll naderin_tdd_barDialogOpts","He stares at his Tri-Pad for a moment before looking back at you.

""I can't say. Confidential until you accept.""

You get the feeling they don't actually know where it's supposed to be going.",,
naderin_tdd_nervesOpt1,naderin_tdd_barDialogOpts,"!$askedNerves1
!$global.naderin_tdd_missionDeclinedBefore",,,"naderin_tdd_convo1:""You're awfully nervous about this.""",
naderin_tdd_convo1,DialogOptionSelected,"$option == naderin_tdd_convo1","$askedNerves1 = true
FireAll naderin_tdd_barDialogOpts","There's a moment of silence before he responds.

""Am I?"" They chuckle to themselves, but nobody's smiling.",,
naderin_tdd_nervesOpt2,naderin_tdd_barDialogOpts,"$askedNerves1
!$askedNerves2",,,"naderin_tdd_convo2:""You look pretty nervous to me.""",
naderin_tdd_convo2,DialogOptionSelected,"$option == naderin_tdd_convo2","$askedNerves2 = true
FireAll naderin_tdd_barDialogOpts","They blink at you in another moment of silence.

It's far too long before they respond. ""I can't say anything more than I already have. Are you taking the job or not?""",,
naderin_tdd_acceptOpt,naderin_tdd_barDialogOpts,,,,"naderin_tdd_accept:Accept",
naderin_tdd_accept,DialogOptionSelected,"$option == naderin_tdd_accept","unset $askedDetails
unset $askedNerves1
unset $askedNerves2
AdjustRepPerson naderin_harlan FRIENDLY 5","They slam down their Tri-Pad, staring at you with a grin that's just far too wide.

""Yes! Thank you. Thank you, thank you, thank you! You won't regret this!"" There's a flurry of handshakes and tears streaming down his face, and he's far too close for comfort.

Just as the overenthusiastic handshaking begins to feel excessively excessive, he steps back a bit, perhaps realising that dribbling snot all over your shoulder isn't making the best impression on you.","naderin_tdd_accept2:Ask where you're delivering the package",
naderin_tdd_accept2,DialogOptionSelected,"$option == naderin_tdd_accept2","BeginMission naderin_tdd
$global.naderin_tdd_acceptedMission = true","""Ah. Right. You need to know where..."" It's only a few taps later on his Tri-Pad that your own pings with a notification. ""So, the package is on the way to your fleet. But, ah.""

There's always something wrong, isn't there?

""Apologies. You'll need to contact someone over at Derinkuyu for the location of the drop. I'm just a middleman!""

You watch as they scurry off into some corner of the bar, ordering themselves a round of drinks before you can get a word in. 

It's only when your crew begins loading the package — a shielded crate of... something — onto your flagship that you begin to wonder just what you've gotten yourself into.","naderin_tdd_badger:Demand an explanation
naderin_tdd_examine:Examine the package discreetly
backToBar:Return to the bar",
naderin_tdd_badger,DialogOptionSelected,"$option == naderin_tdd_badger",,"By the time you catch up with them, they're dead drunk.

You find it unlikely they'll be able to tell you anything of value.","naderin_tdd_examine:Examine the package discreetly
backToBar:Take a look around the bar",
naderin_tdd_examine,DialogOptionSelected,"$option == naderin_tdd_examine","HideFirstPerson
ShowDefaultVisual","In this day and age, only the most trusting of captains agree to deliver things without checking what they're carrying. You are not one of them.

With practiced precision, your technicians and engineers crack open the shielded crate without tripping any alarms or hidden security measures. It doesn't take long to discover a custom-built miniaturized stealth relay, folded neatly and waiting to conduct any number of nefarious schemes upon its enemies.

""Hey, watch it!"" You hear your chief engineer suddenly bark over comms, overeager machinery powering down in the background. ""The crate was one thing, this is another. Everyone knows these things could be rigged to explode if you touch them wrong. Plus, if we break it apart... well. Scans first.""","naderin_tdd_examine2:Watch your crew get to work",
naderin_tdd_examine2,DialogOptionSelected,"$option == naderin_tdd_examine2",,"It is after a few scans (and a lecture on following protocol) that your crew discover that the relay is based on already existing designs, only with significant exterior markings and modifications on top. Non-intrusive examinations of the relay's structure are as thorough as possible, but unfortunately the crew are forced to go without the gung-ho of engineering's brand new laser powered breach cutters.

""Could've sworn... no, it's fine work, but not military. Whoever made this slapped on some exterior modifications to a common, downscaled design, which reminds me of the shortcuts you'd find apprentices make on their assessments."" Your chief engineer chuckles to themselves, shaking their head a little. ""I suppose this level of makeshift work could plausibly pass for spaceworthy. Not that anyone in their right mind would ever consider it up to code.""","naderin_tdd_examine3:Continue",
naderin_tdd_examine3,DialogOptionSelected,"$option == naderin_tdd_examine3",,"It doesn't take too long for the final report to show up on your Tri-Pad.

""Looks like this is meant to just broadcast a message,"" your tech officer reports to you. ""What message, if any, we can only know when we make the drop.""","backToBar:Return to the bar",
naderin_tdd_declineOpt,naderin_tdd_barDialogOpts,,,,"naderin_tdd_decline:Decline",
naderin_tdd_decline,DialogOptionSelected,"$option == naderin_tdd_decline","$global.naderin_tdd_missionDeclinedBefore = true","""Oh. Okay.""

That's all he says to you as you walk away.
OR
""Ah. Well. That's fine.""

He returns to their Tri-Pad, tapping away for reasons only they know.","backToBar:Take a look around the bar",
"#END Starting Bar Event",,,,,,
,,,,,,
# Contact Remy,,,,,,
naderin_tdd_remyGreeting,PickGreeting,"$id == naderin_remy
Call $naderin_tdd_ref updateData
$naderin_tdd_stage == CONTACT score:1000","ShowPersonVisual
FireAll PopulateOptions","The moment you connect, you see Remy staring at you with bloodshot eyes. Behind him, you see empty alcohol bottles littering his apartment, accompanied by soaked paper documents strewn about haphazardly.",,
naderin_tdd_remyConvOpts,PopulateOptions,"$id == naderin_remy
Call $naderin_tdd_ref updateData
$naderin_tdd_stage == CONTACT score:1000",,,"naderin_tdd_remyHello:""Hello?""
naderin_tdd_remyDetails:""I was told to call you for the details about a dead drop.""
naderin_tdd_remyNothing:Say nothing",
naderin_tdd_remyHello,DialogOptionSelected,"$option == naderin_tdd_remyHello",,"They blink at you for a few seconds before suddenly sitting up in their seat, trying to regain some sense of composure.

""Ah, yes, hello! Bright stars, and all that. What are you here for?""","naderin_tdd_remyHello2:""Do the words 'dead drop' ring any bells for you?""
naderin_tdd_remyDetails:""I was told to call you for the details about a dead drop.""",
naderin_tdd_remyHello2,DialogOptionSelected,"$option == naderin_tdd_remyHello2",,"""What? Oh, it's you! Harlan sent me a message the moment you said yes.""

""I wasn't expecting anyone to take on this mission after how long I'd been waiting... but now that you're here, I can finally get this thing off my back! You have no idea all the troubles I've had to go through. Getting Harlan to ask around was my last resort. After talking to all those stuck-up assholes myself—""

Remy decides at that moment to take a swig of alcohol from a bottle beside him, as if there were some metaphorical weight lifting off their shoulders.

""I really can't thank you enough. I mean it. Really.""","naderin_tdd_remyDetails:Ask where you're delivering the drop",
naderin_tdd_remyNothing,DialogOptionSelected,"$option == naderin_tdd_remyNothing",,"You stare silently at them, waiting for a response. Remy simply stares back, also waiting for you to say something.

Seconds go by before you get the feeling that you should probably start talking.","naderin_tdd_remyHello:""Hello?""
naderin_tdd_remyDetails:""I was told to call you for the details about a dead drop.""",
naderin_tdd_remyDetails,DialogOptionSelected,"$option == naderin_tdd_remyDetails","Call $naderin_tdd_ref viewMap ""Destination: $naderin_tdd_systemName""
Call $naderin_tdd_ref updateStage
FireAll naderin_tdd_remyDetailOpts
SetTextHighlights $naderin_tdd_systemName $naderin_tdd_dist
$naderin_tdd_drop = true","Remy slaps their forehead. ""Right! That! Why else, but... You're here to... yeah, yeah.""

He leans off to the side, picking up a datapad. ""If you would please go to the $naderin_tdd_systemName about $naderin_tdd_dist light-years away, and drop off the package at the location specified there...""

His voice trails off into the air. Your nav officer receives a ping moments later. Coordinates received.

""That would be perfect!"" Remy beams at you with a thankful smile. ""I trust you can get this done in a jiffy, despite the danger! But no rush, no rush. There's no deadline for this mission. Good luck!""",,"# Call viewMap is not vanilla
# SetStoryPoint fractions found/set in settings.json
# Some of those scripts are probably unnecessary"
naderin_tdd_askDangerOpt,naderin_tdd_remyDetailOpts,"!$askedAboutDanger",,,"naderin_tdd_askDanger:""Danger?""",
naderin_tdd_askDanger,DialogOptionSelected,"$option == naderin_tdd_askDanger","$askedAboutDanger = true
FireAll naderin_tdd_remyDetailOpts","""Oh. Uh. Just a few pirates on the way, that's all. It's sort of the reason nobody wanted to take the mission."" Remy chuckles to himself, as if not believing his own words.

""Nothing someone like you can't handle, though. Right?""",,
naderin_tdd_askCrewOpt,naderin_tdd_remyDetailOpts,"$askedAboutDanger
!$askedCrewAboutDanger",,,"naderin_tdd_askCrew:Ask your information officer about the 'danger'",
naderin_tdd_askCrew,DialogOptionSelected,"$option == naderin_tdd_askCrew",,"Your officer taps a bit on their console, but it's clear that they already know what the danger might be about.

""There's rumours. They all seem wholly unsubstantiated, but there's something that comes up just enough that people think it could be true. It's the name, 'Kanta'.""","naderin_tdd_askCrew2:Continue",
naderin_tdd_askCrew2,DialogOptionSelected,"$option == naderin_tdd_askCrew2","$askedCrewAboutDanger = true
FireAll naderin_tdd_remyDetailOpts","""It's not clear how they're related. But I'd bet they're related somehow.""

Your ops chief chimes in from the side. ""There's every chance the rumors are all fabricated. Nothing like slandering someone on the local forums to run them out of business.""

There's nothing concrete, but you realise you do have the option of just asking Remy outright.",,
naderin_tdd_askCrew3Opt,naderin_tdd_remyDetailOpts,"$askedCrewAboutDanger
!$askedRemyAboutDanger",,,"naderin_tdd_askCrew3:Confront Remy with this information",
naderin_tdd_askCrew3,DialogOptionSelected,"$option == naderin_tdd_askCrew3","$askedRemyAboutDanger = true
FireAll naderin_tdd_remyDetailOpts","""Uh, Kanta? That Kanta?"" He blinks for a second, an eyebrow raised in thought. ""If I were on her bad side, I'd be dead. And if I were on her good side, well, I wouldn't be here.""

He swishes his bottle of cheap alcohol around idly. You don't have the impression that Remy's much of a good actor, but it's certainly possible that he's lying.

It's equally possible that you're overthinking this.",,
naderin_tdd_askForMoreOpt,naderin_tdd_remyDetailOpts,"!$askedForMore","SetStoryOption naderin_tdd_askForMore 1 naderin_askedForMoney ui_char_spent_story_point ""Convinced Remy to give you more credits to complete a dead drop""",,"naderin_tdd_askForMore:""Actually, that's a little far. I need more credits.""",
naderin_tdd_askForMore,DialogOptionSelected,"$option == naderin_tdd_askForMore",,"The pay might already be enough to cover anyone else's expenses, but you think you could make a pretty good case as to why you of all people deserve a little extra.

""What? Why would you need...?""","naderin_tdd_askForMore2:Explain the risks you're taking",
naderin_tdd_askForMore2,DialogOptionSelected,"$option == naderin_tdd_askForMore2",,"You make a few vague statements, letting Remy do all the thinking in your stead. Over a matter of minutes, you slowly see his face change several times as the gears click in his brain.

""...right, right. More credits would make sense. You need fuel and supplies, and maybe a little extra as a buffer for unforeseen damages. That'd mean this would have to be an advance on the original reward. And then add some more for delivering something nobody else wanted to deliver...""","naderin_tdd_askForMore3Opt1:""You're starting to understand now.""
naderin_tdd_askForMore3Opt2:Stay silent","# despite leading to the same dialogue, these options have to be different to prevent breaking keyboard shortcuts (i.e. the press 1 for opt 1, 2 for 2, etc.)"
naderin_tdd_askForMore3Opt1,DialogOptionSelected,"$option == naderin_tdd_askForMore3Opt1","$option = naderin_tdd_askForMore3
FireBest DialogOptionSelected",,,
naderin_tdd_askForMore3Opt2,DialogOptionSelected,"$option == naderin_tdd_askForMore3Opt2","$option = naderin_tdd_askForMore3
FireBest DialogOptionSelected",,,
naderin_tdd_askForMore3,DialogOptionSelected,"$option == naderin_tdd_askForMore3","AddCredits 25000
$askedForMore = true
Call $naderin_tdd_ref updateStage","Eventually, you see the credits enter your account. 

""That's all I can give you on top of what we've already agreed on."" Remy grimaces, tapping rapidly on something off screen. ""Unfortunately, I now have some pressing business to attend to on account of the gaping hole in my account, so if you'll excuse me...""

Then with a swipe of his fingers, Remy cuts off the connection. It seems he'll be busy for a while yet.","cutCommLinkNoText:Continue",
naderin_tdd_remyLeaveOpt,naderin_tdd_remyDetailOpts,,,,"naderin_tdd_remyLeave:Cut the comm link",
naderin_tdd_remyLeave,DialogOptionSelected,"$option == naderin_tdd_remyLeave","$option = cutCommLinkNoText
FireBest DialogOptionSelected
Call $naderin_tdd_ref updateStage","You cut the comm link.

Not a minute after does an apologetic message arrive from Remy, suddenly informing you that you'll have to return to him to recieve payment, rather than immediately upon making the drop.

You get the feeling that there'll be more unforeseen complications in the future.",,
naderin_tdd_greetAgain,PickGreeting,"$id == naderin_remy
Call $naderin_tdd_ref updateData
$naderin_tdd_stage == DROP_OFF score:1000","ShowPersonVisual
FireAll PopulateOptions","Remy looks up and down at you with a frown.

""What is it? Need me to wish you bright burns, and all that?"" He sighs. ""I don't have anything else for you. It's up to you to make the drop, whether it be this cycle or the next. And I appreciate that you've agreed to do it in place of all the other captains that've refused, but...""

They lean in, their face taking up the entire screen.

""You ARE going to make the drop, right? Eventually?""",,
naderin_tdd_greetAgainOpts,PopulateOptions,"$id == naderin_remy
Call $naderin_tdd_ref updateData
$naderin_tdd_stage == DROP_OFF score:1000",,,"naderin_tdd_greetAgainYes:""Of course.""
naderin_tdd_greetAgainMaybe:""I'll get around to it.""
naderin_tdd_greetAgainNo:""No.""
naderin_tdd_greetAgainSilence:Say nothing",
naderin_tdd_greetAgainYes,DialogOptionSelected,"$option == naderin_tdd_greetAgainYes",,"There's a sigh of relief as they lean back into their seat.

""Right, right. You aren't the kind of space captain to renege on their promises, leaving missions incomplete. I knew you were the good sort right from the start!""

Already, you see another cheap bottle of liquor being dragged out from the side. Remy takes large gulps of his drink as you ponder what to do next.","cutCommLink:Cut the comm link",
naderin_tdd_greetAgainMaybe,DialogOptionSelected,"$option == naderin_tdd_greetAgainMaybe",,"Remy blinks at you.

""Well, as long as you do it at some point, I'm happy with that. You aren't getting paid until you do it after all!""

You watch as another cheap bottle of liquor is dragged out from the side. Remy takes large gulps of his drink as you ponder what to do next.","cutCommLink:Cut the comm link",
naderin_tdd_greetAgainNo,DialogOptionSelected,"$option == naderin_tdd_greetAgainNo",,"One second of silence drags out to two, then four, then eight, then sixteen...

""You're joking, right?""","cutCommLink:Cut the comm link",
naderin_tdd_greetAgainSilence,DialogOptionSelected,"$option == naderin_tdd_greetAgainSilence",,"Remy shakes their head. ""It was just one of them rhetorical questions anyway. Well, I have business to attend to, so burn bright captain, and I'll hopefully see you later when you've done your job. Because you will do it! Right? Right!?""

They look at you, then at the bottles strewn about behind them, then again back at you.

""Okay! Anyway, I won't keep you! Bye!"" It's at that very second that they begin mashing at the cut-off button, leaving you to wonder just what crazy thoughts your silence has put in their head.","cutCommLinkNoText:Continue",
"#END Contact Remy",,,,,,
,,,,,,
# Drop Interaction,,,,,,
naderin_tdd_printHostilesText,OpenInteractionDialog,"$naderin_tdd_target score:1000
IsSeenByAnyFleet
Call $naderin_tdd_ref updateData","ShowDefaultVisual","Your $shipOrFleet was recently detected - or is currently being tracked by - a nearby fleet, and dropping off the shielded crate at the specified location is extremely inadvisable.","defaultLeave:Leave",
naderin_tdd_objectInteraction,OpenInteractionDialog,"$naderin_tdd_target score:1000
Call $naderin_tdd_ref updateData","ShowDefaultVisual","Your nav officer reports that your $shipOrFleet has arrived at the coordinates provided by $naderin_tdd_personName.

Preparations have already been made to handle whatever trouble might come out of this dead drop - notably far more than most other drops you've done before. Ship sensors are primed, guns readied, and crew on high alert.

The $naderin_tdd_thing is held gently in a cargo drone's manipulator arms, ready for deployment. The go-button flashes softly on your command interface.","naderin_tdd_objectScan1:Drop it off in a stable orbit
defaultLeave:Leave",
naderin_tdd_objectScan1,DialogOptionSelected,"$option == naderin_tdd_objectScan1","ShowImageVisual vanilla_generic_probe","The bay doors open, and the cargo drone extends its arms. Then, gently, its manipulators release.

There's a moment of bated breath as a miniaturized stealth relay unfolds itself, sliding out of the now unshielded crate. You watch the display feed as maneuvering thrusters softly glide the relay away from your flagship, and into space.

The image flickers, warbles, shakes... then nothing.

Your sensors officer looks up, a thin sheen of sweat on their forehead. ""$PlayerSirOrMadam, we've lost the nav. It's gone.""","naderin_tdd_objectScan2:Continue","# generic_probe wasn't available, so I just copied it from the files and added it into the mod as vanilla_generic_probe (also involves settings.json)"
naderin_tdd_objectScan2,DialogOptionSelected,"$option == naderin_tdd_objectScan2",,"There's a sense of déjà vu as crew chatter quietly over comms, incredulous. Was that it? Just a souped-up civilian relay made for military-spec adventures? No trigger-happy fleets coming to claim the lives of your crew any more than usual?

""There were rumours,"" your sensors officer mumbles aloud to themselves. ""Nobody thought it was worth the risk.""","naderin_tdd_objectScanSuperstitions:""Sometimes, rumors are just that. Nothing more.""
naderin_tdd_objectScanWhy:""There's something coming our way, isn't there?""
naderin_tdd_objectScan3:Continue",
naderin_tdd_objectScanSuperstitions,DialogOptionSelected,"$option == naderin_tdd_objectScanSuperstitions","$player.ethosKnowledge++","Your crew exchange glances.

""As you say, $playerSirOrMadam.""","naderin_tdd_objectScan3:Continue",
naderin_tdd_objectScanWhy,DialogOptionSelected,"$option == naderin_tdd_objectScanWhy",,"""There's nothing new on sensors, $playerSirOrMadam."" Your crew exchange glances as your sensors officer double-checks their work. ""I can't see any reason for concern at the moment, but...""","naderin_tdd_objectScan3:Continue",
naderin_tdd_objectScan3,DialogOptionSelected,"$option == naderin_tdd_objectScan3","ShowDefaultVisual","Just as your crew begin to second-guess themselves, a garbled hyperwave burst blares out from the relay without warning. And then, as if having fulfilled its purpose, it shudders back into view of your sensors... and then breaks apart into multiple pieces.

Your comms officer taps at their console, but they appear to make no progress. ""The hyperwave message is just junk. Nothing we can sift out from the static, $playerSirOrMadam.""

""That relay was junk,"" your chief engineer scoffs from the side. ""But failing like that? I can't believe I even thought it was spaceworthy.""","naderin_tdd_objectScan4:Order the relay's remains analysed",
naderin_tdd_objectScan4,DialogOptionSelected,"$option == naderin_tdd_objectScan4","$naderin_tdd_submit = true
Call $naderin_tdd_ref updateStage
DespawnEntity","Salvage crews depart shortly after you give the order, and results come in promptly without issue.

""Now that we were able to take a closer look, we were able to confirm that there wasn't much of a chance of it working properly in the first place. A modified relay like this? It's like self-sabotage with how shoddy the workmanship is.""

Despite this, your sensors officer notes that even if the onboard electronics were turned to slag when the thing tore itself apart, the garbled hyperwave burst was certainly still strong enough to alert any nearby fleets of your presence.","defaultLeave:Leave",
"#END Drop Interaction",,,,,,
,,,,,,
# Pirate Interaction,,,,,,
naderin_tdd_pirateEncounter,BeginFleetEncounter,"$naderin_tdd_pirates_ref score:3000
!$entity.tdd_alreadyMetPlayer
# Call $naderin_tdd_ref updateData","FleetDesc
# AddText ""These are probably the pirates Remy was talking about.""",,,
naderin_tdd_pirateCommsFriendly,OpenCommLink,"$faction.friendlyToPlayer
$entity.naderin_tdd_pirates_ref score:3000
!$entity.isHostile
!$entity.tdd_alreadyMetPlayer","$entity.tdd_alreadyMetPlayer
FireAll PopulateOptions","""Ah. Hm? Thought you were someone else.""",,
naderin_tdd_pirateOptFriendly,PopulateOptions,"$faction.friendlyToPlayer
$entity.naderin_tdd_pirates_ref score:100
!$tdd_askedQuestion",,,"naderin_tdd_pirateHeardFriendly:""Are you, by chance, here to intercept a drop?""",
naderin_tdd_pirateHeardFriendly,DialogOptionSelected,"$option == naderin_tdd_pirateHeardFriendly","$tdd_askedQuestion = true
FireAll PopulateOptions","""Eh? Not a clue what you're talking about.""

It's quickly made clear that these pirates are here because they heard a particular mercenary fleet was passing through here, but mentions of a dead drop are only met with blank stares.",,
naderin_tdd_pirateCommsNeutral,OpenCommLink,"$entity.naderin_tdd_pirates_ref score:3000
!$entity.isHostile
!$entity.tdd_alreadyMetPlayer","$entity.tdd_alreadyMetPlayer = true
# $menuState = fleetConvMain 0
FireAll PopulateOptions","""Daft or somethin'? What're you talkin' to us for?""",,
naderin_tdd_pirateOptNeutral,PopulateOptions,"$entity.naderin_tdd_pirates_ref score:3000
$faction.neutralToPlayer
!$entity.isHostile
!$tdd_askedQuestion",,,"naderin_tdd_pirateHeardNeutral:""Intercepting a dead drop today?""",
naderin_tdd_pirateHeardNeutral,DialogOptionSelected,"$option == naderin_tdd_pirateHeardNeutral","$tdd_askedQuestion = true
FireAll PopulateOptions","""What sort of question is that? Get lost.""

Further questions are met with varying mixes of indifference and annoyance. It's clear you aren't getting anything out of them.",,
naderin_tdd_pirateCommsHostile,OpenCommLink,"$entity.naderin_tdd_pirates_ref score:3000
!$entity.tdd_alreadyMetPlayer","$entity.tdd_alreadyMetPlayer = true
$entity.ignorePlayerCommRequests = true 1
FireAll PopulateOptions","The comms line fizzles into being. On your screen, the pirate $personRank seems to lean to the side for a second as someone speaks into their ear.

""I suppose we could have ourselves a talk before the blasting starts."" $HeOrShe raises a brow, then alternates between raising one or the other in some sort of a mocking gesture. ""So? Speak 'fore we get bored.""",,"# Score might have to be high to override generic pirate dialog rule
# also, conditions make this a fall-back rule"
naderin_tdd_pirateOptHostile,PopulateOptions,"$entity.naderin_tdd_pirates_ref score:3000
$entity.isHostile
!$tdd_askedQuestion",,,"naderin_tdd_pirateHeardHostile:""You're here for the drop, aren't you?""",
naderin_tdd_pirateHeardHostile,DialogOptionSelected,"$option == naderin_tdd_pirateHeardHostile","$tdd_askedQuestion = true
FireAll PopulateOptions","""What? That's what you wanted to ask?"" $HeOrShe deflates in disappointment, their good humour fading into impatience.

""Why would we ever tell you, you rad-addled dirt-scrubber?""",,
"#END Pirate Interaction",,,,,,
,,,,,,
# Mercenary Interaction,,,,,,
naderin_tdd_mercFleetEncounter,BeginFleetEncounter,"$naderin_tdd_merc_ref score: 100
!$entity.alreadyTalkedToPlayer
!$player.naderin_tdd_talkedToMerc","FleetDesc
HailPlayer",,,"# in this mission, we'll only consider them ""met"" if the player talks to them"
naderin_tdd_mercInitialOpen,OpenCommLink,"$entity.naderin_tdd_merc_ref score:100
!$entity.alreadyTalkedToPlayer
!$entity.tookTheDeal","$entity.alreadyTalkedToPlayer = true
$player.naderin_tdd_talkedToMerc = true
SetTextHighlights 10,000
FireAll naderin_tdd_mercOpts","$personName looks at you with a blank gaze.

They don't bother with pleasantries, getting straight to business. ""The location of your drop, and you get 10,000 credits. Deal?""",,
naderin_tdd_mercOpen,OpenCommLink,"$entity.naderin_tdd_merc_ref score:100
$entity.alreadyTalkedToPlayer
!$entity.tookTheDeal","SetTextHighlights 10,000
FireAll naderin_tdd_mercOpts","$personName looks at you with a blank gaze, but there's a hint of annoyance there now.

""Changed your mind? The location of your drop, and you get 10,000 credits. Deal?""",,
naderin_tdd_mercDetailsOpt,naderin_tdd_mercOpts,"!$askedForDetails",,,"naderin_tdd_mercDetails:""What do you need that information for?""",
naderin_tdd_mercDetails,DialogOptionSelected,"$option == naderin_tdd_mercDetails","$askedForDetails = true
FireAll naderin_tdd_mercOpts","""You know how it is. Confidential.""",,
naderin_tdd_mercDetailsOpt2,naderin_tdd_mercOpts,"$askedForDetails
!$askedToConvince",,,"naderin_tdd_mercDetails2:""Is there no way I could convince you otherwise?""",
naderin_tdd_mercDetails2,DialogOptionSelected,"$option == naderin_tdd_mercDetails2","$askedToConvince = true
FireAll naderin_tdd_mercOpts","""A contract's a contract. But."" $HeOrShe gives you a crack of a smile.

""As one captain to another, I believe you might be better suited asking questions to your employer. They are the one responsible, no? Better their words than mine. Now, do we have a deal?""",,
naderin_tdd_mercJustThatOpt,naderin_tdd_mercOpts,"!$askedJustThat",,,"naderin_tdd_mercJustThat:""And all you want is the location?""",
naderin_tdd_mercJustThat,DialogOptionSelected,"$option == naderin_tdd_mercJustThat","$askedJustThat = true
FireAll naderin_tdd_mercOpts","""Nothing about the drop itself. Or you. Just the location of the drop, captain.""",,
naderin_tdd_mercAndIfOpt,naderin_tdd_mercOpts,"!$askedAndIf",,,"naderin_tdd_mercAndIf:""And if we refuse?""",
naderin_tdd_mercAndIf,DialogOptionSelected,"$option == naderin_tdd_mercAndIf","$askedAndIf = true
FireAll naderin_tdd_mercOpts","There's a hint of exasperation on $hisOrHer face now. ""We will not be resorting to violence, if that is what you are asking.""",,
naderin_tdd_mercDealOpt,naderin_tdd_mercOpts,,,,"naderin_tdd_mercDeal:Accept the deal and transmit coordinates",
naderin_tdd_mercDeal,DialogOptionSelected,"$option == naderin_tdd_mercDeal","$entity.tookTheDeal = true
MakeOtherFleetImportant false
AddTextSmall ""Coordinates transmitted to $personName"" highlight
AddCredits 10000","""A pleasure doing business with you, captain.""","cutCommLink:Cut the comm link",
naderin_tdd_mercRefuseOpt,naderin_tdd_mercOpts,,,,"naderin_tdd_mercRefuse:Refuse",
naderin_tdd_mercRefuse,DialogOptionSelected,"$option == naderin_tdd_mercRefuse",,"The mercenary $personRank sighs before cutting the comm link.","cutCommLinkNoText:Continue",
naderin_tdd_mercCutCommsOpt,naderin_tdd_mercOpts,,,,"cutCommLink:Cut the comm link",
"#END Mercenary Interaction",,,,,,
,,,,,,
# After The Drop,,,,,,
naderin_tdd_remyGreetAgain,PickGreeting,"$id == naderin_remy
$naderin_tdd_stage == SUBMIT score:1000","ShowPersonVisual
FireAll PopulateOptions","You connect immediately.

The glow of a console flickers rapidly on Remy's face. Busy no doubt, but the flickering calms with a tap, and Remy focuses his attention onto you.

""You're back.""",,
naderin_tdd_remyConvOpts2,PopulateOptions,"$id == naderin_remy
$naderin_tdd_stage == SUBMIT score:1000",,,"naderin_tdd_remyConv1:""You have some explaining to do.""
naderin_tdd_remyConv2:""There was an issue with the drop.""",
naderin_tdd_remyConv1,DialogOptionSelected,"$option == naderin_tdd_remyConv1","$option = naderin_tdd_remyConv3
FireBest DialogOptionSelected","""I do, don't I?""",,
naderin_tdd_remyConv2,DialogOptionSelected,"$option == naderin_tdd_remyConv2","$option = naderin_tdd_remyConv3
FireBest DialogOptionSelected","""I know. I know.""",,
naderin_tdd_remyConv3,DialogOptionSelected,"$option == naderin_tdd_remyConv3",,"Remy sighs, leaning back in his chair. ""Ah, whatever. I'll just tell you now. I'm in debt.""","naderin_tdd_remyConvDebt:""Debt?""
naderin_tdd_remyConvDebtWho:""Who are you indebted to?""",
naderin_tdd_remyConvDebt,DialogOptionSelected,"$option == naderin_tdd_remyConvDebt",,"""Yes. Debt. What, is this a foreign concept to you?""","naderin_tdd_remyConvDebtNo:""No, I've never been in debt.""
naderin_tdd_remyConvDebtMock:""Debt is for losers.""
naderin_tdd_remyConvDebtComisserate:""Yeah. Those Tri-Tachyon investors, huh?""
naderin_tdd_remyConvDebtWho:""Who are you indebted to?""",
naderin_tdd_remyConvDebtNo,DialogOptionSelected,"$option == naderin_tdd_remyConvDebtNo",,"He shakes his head, envious. ""Lucky you, captain. Lucky you.""","naderin_tdd_remyConvDebtWho:""Who are you in debt to?""",
naderin_tdd_remyConvDebtMock,DialogOptionSelected,"$option == naderin_tdd_remyConvDebtMock","AdjustRepPerson naderin_remy SUSPICIOUS -1","""Laugh all you like now, captain. If there's anything I'm sure of, it's death, taxes... and debt.""","naderin_tdd_remyConvDebtWho:""Who are you in debt to?""",
naderin_tdd_remyConvDebtComisserate,DialogOptionSelected,"$option == naderin_tdd_remyConvDebtComisserate","AdjustRepPerson naderin_remy FRIENDLY 1","""Ah, those lot. You've run into them? I thought about getting a loan from them once, but their fees were outrageous! It's crazy what those bloodsuckers are willing to do to get a credit, huh?""","naderin_tdd_remyConvDebtWho:""Who are you in debt to?""",
naderin_tdd_remyConvDebtWho,DialogOptionSelected,"$option == naderin_tdd_remyConvDebtWho",,"""Ah. Well. It's a funny story. Sort of. More of a long story, really. Um."" Remy hesitates for a second.

""Okay, yeah. It's pirates. I'm in debt to pirates.""","naderin_tdd_remyConvDebtPirates:""Pirates?""",
naderin_tdd_remyConvDebtPirates,DialogOptionSelected,"$option == naderin_tdd_remyConvDebtPirates",,"""Yep. Pirates.""","naderin_tdd_remyConvDebtPirates2:""Pirates.""
naderin_tdd_remyConvDebtDoubt:""Really?""",
naderin_tdd_remyConvDebtPirates2,DialogOptionSelected,"$option == naderin_tdd_remyConvDebtPirates2",,"""Pirates. Yeah. Those guys.""","naderin_tdd_remyConvDebtDoubt:""Really?""",
naderin_tdd_remyConvDebtDoubt,DialogOptionSelected,"$option == naderin_tdd_remyConvDebtDoubt",,"He coughs. ""I mean, sure, pirates rob and pillage and all that. They aren't in their right minds half of the time. But they're, you know, pirates. If they knew you could mug someone of credits you don't even have, well...""

""Never mind that."" Remy waves a hand dismissively, not wanting to speak more of it. ""The whole point of the drop was to get a message across to someone in the system. That it failed... well, that was actually on purpose.""","naderin_tdd_remyDrop:""On purpose?""",
naderin_tdd_remyDrop,DialogOptionSelected,"$option == naderin_tdd_remyDrop","FireAll naderin_tdd_remyDropOpts","""Ha, well, let me give you a bit of context. You see, my debt isn't really just a matter of credits. My activities here make bank, so that's not an issue.""

Remy turns to the side for a moment, tapping for a second on their console. ""It's a debt in the sense that I messed up one of their jobs. Now I owe them a whole slew of favours in lieu of payment. One of them being the drop.""

""And that makeshift relay you deployed for me didn't really fail at all. It just pretended to. If it fooled you, then it should have fooled everyone else too, which is great. It all worked out in the end.""

""Though I admit,"" he pauses, ""the relay wasn't supposed to fail as spectacularly as it did. Well, in the sense that making something fail only for it to fail to fail... well, it's ironic, isn't it?""",,
naderin_tdd_remyDropIntentionalOpt,naderin_tdd_remyDropOpts,"!$askedIntentional",,,"naderin_tdd_remyDropIntentional:""So it was unintentionally intentional?""",
naderin_tdd_remyDropIntentional,DialogOptionSelected,"$option == naderin_tdd_remyDropIntentional","$askedIntentional = true
FireAll naderin_tdd_remyDropOpts","""Almost. Intentional sabotage would have been far too obvious, so I had to attempt more subtle means of failure. But who knew the thing was shoddy enough to break on it's own?""

Remy shrugs. ""Either way, it bought me some time. Time for... well. Enough for you to help me, if you're down for it.""",,
naderin_tdd_remyDropMercOpt,naderin_tdd_remyDropOpts,"$player.naderin_tdd_talkedToMerc == true
!$askedMerc",,,"naderin_tdd_remyDropMerc:""It fooled a merc, too. They wanted to know about the drop.""",
naderin_tdd_remyDropMerc,DialogOptionSelected,"$option == naderin_tdd_remyDropMerc","$askedMerc = true
FireAll naderin_tdd_remyDropOpts","""Mercenaries?""

Remy narrows his eyes, looking off to the side in thought. ""It can't have been that important, surely? But if what you say is true...""",,
naderin_tdd_remyHelpOpt,naderin_tdd_remyDropOpts,"$player.naderin_tdd_talkedToMerc == true
$askedIntentional",,,"naderin_tdd_remyHelp:""You want my help?""",
naderin_tdd_remyHelp,DialogOptionSelected,"$option == naderin_tdd_remyHelp","FireAll naderin_remyHelpOpts","""Not for free. For credits, of course! You're the kind of person who'd do anything for money, right?""",,
naderin_tdd_remyHelpYesOpt,naderin_remyHelpOpts,,,,"naderin_remyHelpYes:""You could say that.""",
naderin_tdd_remyHelpYes,DialogOptionSelected,"$option == naderin_remyHelpYes","AdjustRepPerson naderin_remy COOPERATIVE 5
AddXP 5000
$naderin_tdd_completed = true
Call $naderin_tdd_ref updateStage","""Great!"" Remy beams at you. ""I don't have any pressing tasks at the moment, but if you drop by a while later, I should have something for you.""","naderin_tdd_remyFinal:Continue",
naderin_tdd_remyHelpGreedyOpt,naderin_remyHelpOpts,,,,"naderin_tdd_remyHelpGreedy:""My services are very much for sale.""",
naderin_tdd_remyHelpGreedy,DialogOptionSelected,"$option == naderin_tdd_remyHelpGreedy","$player.ethosMercenary++
$naderin_tdd_completed = true
Call $naderin_tdd_ref updateStage
AdjustRepPerson naderin_remy FRIENDLY 5","""Great! If not concerning. But anyway."" Remy beams at you. ""I don't have any pressing tasks at the moment, but if you drop by a while later, I should have something for you.""","naderin_tdd_remyFinal:Continue",
naderin_tdd_remyHelpMaybeOpts,naderin_remyHelpOpts,,,,"naderin_tdd_remyHelpMaybe:""Not always.""",
naderin_tdd_remyHelpMaybe,DialogOptionSelected,"$option == naderin_tdd_remyHelpMaybe","$naderin_tdd_completed = true
Call $naderin_tdd_ref updateStage
AdjustRepPerson naderin_remy FRIENDLY 5","""Fair enough. I'm glad you're open to the idea nonetheless."" Remy beams at you. ""I don't have any pressing tasks at the moment, but if you drop by a while later, I should have something for you.""","naderin_tdd_remyFinal:Continue",
naderin_tdd_remyHelpNoOpts,naderin_remyHelpOpts,,,,"naderin_tdd_remyHelpNo:""I can't help you any further than this.""",
naderin_tdd_remyHelpNo,DialogOptionSelected,"$option == naderin_tdd_remyHelpNo","$naderin_tdd_completed = true
Call $naderin_tdd_ref updateStage
AdjustRepPerson naderin_remy FRIENDLY 5","""That's a shame."" Remy sighs in disappointment. ""But if you're still open to the idea in the future, drop by anytime. I'll have something ready for you.""","naderin_tdd_remyFinal:Continue",
naderin_tdd_remyFinal,DialogOptionSelected,"$option == naderin_tdd_remyFinal","AddPotentialContact naderin_remy
unsetAll $naderin_tdd","Your conversation is interrupted by a confirmation of payment on your side, and the ping of notifications stacking up on Remy's side of the call. ""Ah, excuse me. Work's piling up. You probably still have a lot of questions. But that... that'll have to be for another time.""

""As riveting as our talk was, I really must be going."" You realise that Remy is already holding a cheap bottle of liquor, ready to drink himself to oblivion. With a tap, lines of text trail across his screen, the glow of his console flickering with worrying speed onto his tired eyes.

""I'll see you later! Hopefully. Burn bright, captain.""","cutCommLink:Cut the comm link",
"#END After The Drop",,,,,,
"#END The Derinkuyu Drop",,,,,,
,,,,,,
# Remy,,,,,,
naderin_remyDefaultGreeting,PickGreeting,"$id == naderin_remy score:20","ShowPersonVisual
FireAll PopulateOptions","There's a shuffling of papers before Remy appears on-screen.

""This is Remy. Who's this?""
OR
""Ah, hello. Bright stars and all that. This is Remy. What's going on?"" Remy appears on-screen, strangely a little disheveled but no worse for wear.
OR
You wait several moments before the call connects.

""Uh, Remy here."" Remy looks at you, rubbing their eyes. ""Can I help you?""",,
naderin_remyContactPrintAcceptText,ContactPrintAcceptText,"$id == naderin_remy score:200",,"""Nice.""
OR
""Good luck with that, captain.""
OR
$HeOrShe simply nods. ""A good dealing, I think you'll agree.""",,"# there's also a trigger for decline dialogue, which I might add in later"
,,,,,,
# NEW DIRECTORY,,,,,,
"#END NEW DIRECTORY",,,,,,
,,,,,,
# Ship Hijacking (Vanilla),,,,,,
naderin_remy_hijackBlurb,hijack_blurb,"$id == naderin_remy score:200",,"""Some idiot parked their ship in front of one of my warehouses. I was planning to get it towed, but we could just as easily arrange it to be, ah, stolen.""",,
naderin_remy_hijackOfferTextContact,DialogOptionSelected,"$option == hijack_start
$id == naderin_remy score:200","$missionId = hijack
SetTextHighlights $hijack_price $hijack_marines","""This $hijack_hull $hijack_designation is, for some reason, parked incorrectly in front of one of my warehouses! And honestly, these days we've got damn fine autopilot, so if you can guess how annoyed I am, hah! The idiot couldn't park on a landing gantry if their life depended on it.""

$HeOrShe takes a moment to calm down before they continue.

""Anyway, for just $hijack_price credits and $hijack_marines marines, we should be able to overwhelm any onboard crew lingering around in there. Don't worry, I've got the security codes, guard schedules, and the support of a few disgruntled MuniSec militia to keep it all hush-hush, if you're willing.""","hijack_look:Ask for detailed info on the military vessel
contact_decline:Decline",
naderin_remy_hijackOperation1,DialogOptionSelected,"$option == hijack_op1
$id == naderin_remy score:200",,"Dressed up in MuniSec garb, your hand-picked marines fall in line with a few actual MuniSec militia. They walk up to the ship, making a racket until the ship's crew poke their noses out to see what's going on.

It's at that time that your marines present them with a forged, but realistic illegal parking ticket, and force the entire crew out of the ship with threats of fines and imprisonment, allowing your own marines to board soon after.

Your marines' weaponry ensures that not a soul dares get any funny ideas of heroism despite the dubious legality of your 'towing operation',","hijack_op2:Continue",
naderin_remy_hijackOperation2,DialogOptionSelected,"$option == hijack_op2
$id == naderin_remy score:200","RemoveCommodity credits $hijack_price
AddShip $hijack_member
Call $hijack_ref repSuccess","You watch on the holofeed as your marines access bridge consoles with ease, the security codes $personName provided making the process smooth sailing. As main power comes online, it takes only minutes before you see your new ship slowly begin to float free of $entity.name's spaceship gantries.

Questions from local authorities are easily answered with fabricated seizure warrants, requests for identification enthusiastically provided by the disgruntled militia from earlier, and questions from the original owner answered with messages of horrifying bureaucracy.

""Apologies ship captain, but your ship has been towed! Please follow the instructions in the letter you will receive shortly to reclaim your ship...""","hijack_op3:Continue",
naderin_remy_hijackOperation3,DialogOptionSelected,"$option == hijack_op3
$id == naderin_remy score:200",,"After the newly liberated ship joins your fleet, you review the after-action report with $personName.

""Clean as can be, but someone's bound to figure out something's up eventually,"" $heOrShe sighs. ""Of course, since the original owner was a bit of a knobhead, I think people will be thanking you rather than angry at you, funnily enough.""","contact_acceptNoText:Continue",
"#END Ship Hijacking (Vanilla)",,,,,,
,,,,,,
# Security Codes (Vanilla),,,,,,
naderin_remy_secoBlurb,seco_blurb,"$id == naderin_remy score:200",,"""I've got the latest $seco_faction facility defense security codes. Should make ground operations a breeze.""",,
naderin_remy_secoOfferTextContact,DialogOptionSelected,"$option == seco_start
$id == naderin_remy score:200","$missionId = seco
SetTextHighlightColors $seco_factionColor h h
SetTextHighlights $seco_faction $seco_price $seco_days
DoCanAffordCheck $seco_price contact_accept false","""Managed to bribe someone for some $seco_faction security codes that'll give you the upper hand in one ground operation, but they'll probably catch on after you use them. I'll send them over for $seco_price credits.""

The codes will be good for $seco_days days before they become useless.","contact_accept:Buy the security codes
contact_decline:Decline",
"#END Security Codes (Vanilla)",,,,,,
,,,,,,
# Extraction Mission (todo),,,,,,
naderin_remyExtr_blurb1,naderin_remyExtr_blurb,"$remyExtr_variation == COLONY",,"""Huh."" $HeOrShe clicks their tongue as their glance at their datapad. ""There's a friend of mine that is, ah, shall we say, in need of extraction. There was an incident that left 'em behind bars, and they want out as soon as possible.""",,"# todo?"
naderin_remyExtr_offerOption1,naderin_remyExtr_offerOption,"$remyExtr_variation == COLONY",,,"naderin_remyExtr_start:Ask about the extraction operation","# todo?"
naderin_remyExtr_offerText1,DialogOptionSelected,"$option == naderin_remyExtr_start",,,"naderin_remyExtr_accept:Accept
naderin_remyExtr_decline:Decline","# todo?"
"#END Extraction Mission (todo)",,,,,,
"#END Remy",,,,,,
"#END Missions",,,,,,

